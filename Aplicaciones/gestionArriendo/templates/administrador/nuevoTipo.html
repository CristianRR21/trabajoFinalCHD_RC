{% extends 'administrador/plantilla.html' %}

{% block contenido %}


<h2 style="text-align: center; font-family: 'Montserrat', sans-serif;">Tipos de Habitaciones</h2><br>
<div class="container">
    <script>
                function confirmarEliminacion(url){
                    Swal.fire({
                        title: '¿Estás seguro?',
                        text: '¡Esta acción no se puede deshacer!',
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Sí, eliminar',
                        cancelButtonText: 'Cancelar'
                        }).then((result) => {
                            if (result.isConfirmed) {
                                window.location.href = url;
                            }
                        });
                    }
          </script>

<h2 style="font-family: 'Montserrat', sans-serif; font-size: 25px; display: flex; align-items: center; gap: 8px;">
  <i class="fa fa-bed" aria-hidden="true"></i> Nuevo tipo de habitación
</h2>

<form method="POST" action="/guardarTipo" class="mt-3" id="nuevoTipo">
    {% csrf_token %}
    
    <div class="mb-3">
        <label for="nombre" class="form-label">Nombre del tipo de habitación</label>
        <input type="text" class="form-control" id="nombre" name="nombre" placeholder="Ej: Departamento, Habitación compartida">
    </div>

    <button type="submit" class="btn btn-primary">Guardar</button>

</form>
</div>
<br>

<div class="table-responsive">
    <table id="tblTipo" class="table table-hover align-middle table-bordered text-center shadow-sm">
        <thead class="table-primary">
            <tr>
                <th>#</th>
                <th>Nombre del tipo de habitación</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% if tipos %}
                {% for tipo in tipos %}
                    <tr>
                        <td>{{ tipo.id }}</td>
                        <td>{{ tipo.nombre }}</td>
                        <td>
                            <button type="button" class="btn btn-warning btn-sm" data-bs-toggle="modal" data-bs-target="#modalEditarTipo{{ tipo.id }}" title="Editar">
                                <i class="fa fa-pen"></i>
                            </button>
                            

                             <a href="#"class="btn btn-outline-danger btn-sm btn-eliminar" title="Eliminar" onclick="confirmarEliminacion('/eliminarTipo/{{tipo.id}}')">
                        <i class="fa fa-trash"></i>
                    </a>
                                                     
                        </td>
                        <!-- Modal de edición para el tipo -->
                            <div class="modal fade" id="modalEditarTipo{{ tipo.id }}" tabindex="-1" aria-labelledby="modalEditarLabel{{ tipo.id }}" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                <form method="POST" action="/editarTipoHabitacion/{{ tipo.id }}/">
                                    {% csrf_token %}
                                    <div class="modal-header">
                                    <h5 class="modal-title" id="modalEditarLabel{{ tipo.id }}">Editar Tipo de Habitación</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                                    </div>
                                    <div class="modal-body">
                                    <div class="mb-3">
                                        <label for="nombreTipo{{ tipo.id }}" class="form-label">Nombre</label>
                                        <input type="text" class="form-control" id="nombreTipo{{ tipo.id }}" name="nombre" value="{{ tipo.nombre }}" required>
                                    </div>
                                    </div>
                                    <div class="modal-footer">
                                    <button type="submit" class="btn btn-primary">Guardar Cambios</button>
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                                    </div>
                                </form>
                                </div>
                            </div>
                            </div>

                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="3" class="text-center text-muted">No hay tipos de habitación registrados aún.</td>
                </tr>
            {% endif %}
        </tbody>
    </table>
</div>


<script>
$(document).ready(function() {
    let table = new DataTable('#tblTipo', {
        language: {
            url: 'https://cdn.datatables.net/plug-ins/2.3.1/i18n/es-ES.json'
        },
        dom: 'Bfrtip', 
        buttons: [
            'copy',
            'csv',
            'excel',
            'pdf',
            'print'
        ]
    });
});
</script>



<script>
    
        $("#nuevoTipo").validate({
            rules: {
                nombre: {
                    required: true,
                    minlength: 5,
                    maxlength: 50
                }
            },
            messages: {
                nombre: {
                    required: "Este campo es obligatorio",
                    minlength: "Debe tener al menos 5 caracteres",
                    maxlength: "No debe exceder los 50 caracteres"
                }
            }
        });
  
</script>




{% endblock %}
