{% extends 'habitaciones/plantilla.html' %}
{% block contenido %}
<br>
{% if usuario %}
    <p>Hola, {{ usuario.username }}!</p>
{% else %}
    <p>No has iniciado sesi√≥n</p>
{% endif %}
          

<style>
  .tarjeta-publicacion {
    background: #fff;
    border: 2px solid #9e9e9e; 

    border-radius: 0.5rem;   
    padding: 1rem;
  }
  
  
</style>
<div id="contenedor-publicaciones" class="container mt-4">
  <a href="/nuevaPublicacion" class="btn btn-success md-4">Nueva Publicaci√≥n</a><br><br>
  {% if publicaciones %}
    {% for pub in publicaciones %}
    <div class="tarjeta-publicacion mb-4">
        
      <div class="row">

        <!-- Imagen izquierda -->
        <div class="col-md-2 col-12 text-center mb-3 mb-md-0" style="height: 155px;">
          {% if pub.foto_url %}
            <img src="{{ pub.foto_url }}" alt="Imagen de {{ pub.titulo }}"
                 style="width: 100%; height: 100%; object-fit: cover;" class="rounded">
          
          {% endif %}
        </div>
        <!-- Detalles centrales -->
        <div class="col-md-8 col-12">
          <h4 class="mb-1 text-primary fw-bold">$ {{ pub.precio }} / mes</h4>
          <h5>{{ pub.titulo }}</h5>
          <p class="mb-1"><strong>Tipo:</strong> {{ pub.tipo }}</p>
          <p class="mb-1" style="font-size: 15px;">{{ pub.descripcion|truncatechars:150 }}</p>
        </div>

    
        <div class="col-md-2 col-12 d-flex flex-column align-items-start justify-content-center gap-2 mt-3 mt-md-0">
          
          <a href="editarPublicacion/{{pub.id}}" class="btn btn-outline-warning btn-sm w-100" title="Editar publicaci√≥n">
            ‚úèÔ∏è Editar
          </a>          
            <br>
          <a href="#" class="btn btn-outline-warning btn-sm w-100" title="Eliminar publicaci√≥n" onclick="confirmarEliminacion('/eliminarPublicacion/{{pub.id}}')">
            üóëÔ∏è Eliminar
          </a>
          
          <script>
                function confirmarEliminacion(url){
                    Swal.fire({
                        title: '¬øEst√°s seguro?',
                        text: '¬°Esta acci√≥n no se puede deshacer!',
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'S√≠, eliminar',
                        cancelButtonText: 'Cancelar'
                        }).then((result) => {
                            if (result.isConfirmed) {
                                window.location.href = url;
                            }
                        });
                    }
          </script>
          
        </div>

      </div>
    </div>
    <br>
    {% endfor %}
  {% else %}
    <div class="alert alert-warning">No hay publicaciones registradas todav√≠a.</div>
  {% endif %}
</div>



{% endblock %}
