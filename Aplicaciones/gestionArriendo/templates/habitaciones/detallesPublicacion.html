{% extends 'habitaciones/plantilla.html' %}

{% block contenido %}
<br>
<div class="container mt-4">

  <!-- Galería de imágenes -->
  {% if fotos %}
  <div class="row mb-4">
    {% for foto in fotos %}
      {% if foto.imagen %}
      <div class="col-md-4 col-sm-6 mb-3">
        <img src="{{ foto.imagen.url }}"
             style="height: 250px; width: 100%; object-fit: cover;" alt="Imagen de la publicación">
      </div>
      {% endif %}
    {% endfor %}
  </div>
  {% endif %}

  <!-- Detalles de la publicación -->
  <div class="col-md-8 col-12 mb-4">
    <h4 class="mb-1 text-primary fw-bold">$ {{ publicacion.precio }} / mes</h4>
    <h5>{{ publicacion.titulo }}</h5>
    <p class="mb-1"><strong>Tipo:</strong> {{ publicacion.tipohabitacion.nombre }}</p>
    <p class="mb-1" style="font-size: 15px;">{{ publicacion.descripcion }}</p>
  </div>

  <!-- Ubicación -->

 <br><br> <br><br> <br><br>
  <div class="mb-5">

    <div class="" id="mapa_cliente" style="border:1px solid black; height:300px;
    width:100%"> </div>
  </div>




 <br><br>
  <h1>COMENTAR</h1>
  <form action="/guardarComentario/{{publicacion.id}}/"  method="post" id="frm_comentario">
       {% csrf_token %}
  <textarea id="comentario" name="comentario" rows="5" cols="50"></textarea>
  <button type="submit">Enviar</button>
  </form>

  <h1>CALIFICAR ESCALA 1-5 </h1>

<form action="/calificarPublicacion/{{publicacion.id}}/" method="post" id="frm_calificacion">
    {% csrf_token %}
    <label for="calificacion">Selecciona una calificación:</label>
    <select id="calificacion" name="calificacion" required>
        <option value="" disabled selected>-- Escoge --</option>
        <option value="1">1 - Muy malo</option>
        <option value="2">2 - Malo</option>
        <option value="3">3 - Regular</option>
        <option value="4">4 - Bueno</option>
        <option value="5">5 - Excelente</option>
    </select>
    <button type="submit">Enviar Calificación</button>
</form>

</div>
 

<script type="text/javascript">
    function initMap() {
        
     
        var lat = parseFloat("{{ publicacion.latitud }}".replace(",", "."));
        var lng = parseFloat("{{ publicacion.longitud }}".replace(",", "."));

        console.log("Latitud:", lat, "Longitud:", lng); 

        var latitud_longitud = new google.maps.LatLng(lat, lng);

        var mapa = new google.maps.Map(document.getElementById('mapa_cliente'), {
            center: latitud_longitud,
            zoom: 15,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });

       var marcador = new google.maps.Marker({
            position: latitud_longitud,
            map: mapa,
            title: "Ubicación de la publicación",
            draggable: false  
        });


        google.maps.event.addListener(marcador, 'dragend', function(event) {
            var latitud = this.getPosition().lat();
            var longitud = this.getPosition().lng();
            document.getElementById("latitud").value = latitud;
            document.getElementById("longitud").value = longitud;
        });
    }
</script>
{% endblock %}

